# AWS RDS Errors - Comprehensive Test Fixtures
# Real-world RDS database creation and configuration errors

# ============================================================================
# Test Case 1: DB Instance Class Not Supported
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.main will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_instance.main: Creating...

│ Error: creating RDS DB Instance (production-postgres): InvalidParameterCombination:
│ RDS does not support creating a DB instance with the following combination:
│ DBInstanceClass=db.t2.micro, Engine=postgres, EngineVersion=15.4,
│ LicenseModel=postgresql-license. For supported combinations of instance class
│ and database engine version, see the documentation.
│
│   with aws_db_instance.main,
│   on database/main.tf line 1, in resource "aws_db_instance" "main":
│    1: resource "aws_db_instance" "main" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 2: DB Subnet Group Invalid
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.replica will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_instance.replica: Creating...

│ Error: creating RDS DB Instance (production-postgres-replica):
│ DBSubnetGroupDoesNotCoverEnoughAZs: The DB subnet group doesn't meet
│ Availability Zone (AZ) coverage requirement. Current AZ coverage: us-east-1a.
│ Add subnets to cover at least 2 AZs.
│
│   with aws_db_instance.replica,
│   on database/replica.tf line 8, in resource "aws_db_instance" "replica":
│    8: resource "aws_db_instance" "replica" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 3: Storage Autoscaling Conflict
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.warehouse will be updated in-place

Plan: 0 to add, 1 to change, 0 to destroy.

aws_db_instance.warehouse: Modifying...

│ Error: modifying RDS DB Instance (data-warehouse): InvalidParameterCombination:
│ You cannot specify a value for AllocatedStorage that is less than
│ the current MaxAllocatedStorage value (500). Reduce MaxAllocatedStorage
│ first if you want to reduce AllocatedStorage.
│
│   with aws_db_instance.warehouse,
│   on database/warehouse.tf line 1, in resource "aws_db_instance" "warehouse":
│    1: resource "aws_db_instance" "warehouse" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 4: Parameter Group Family Mismatch
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.analytics will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_instance.analytics: Creating...

│ Error: creating RDS DB Instance (analytics-mysql): InvalidParameterCombination:
│ The DB parameter group my-mysql57-params has a DB parameter group family of
│ mysql5.7, which doesn't match the DB engine family mysql8.0.
│
│   with aws_db_instance.analytics,
│   on database/analytics.tf line 15, in resource "aws_db_instance" "analytics":
│   15: resource "aws_db_instance" "analytics" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 5: Snapshot Restore - Insufficient Storage
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.restored will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_instance.restored: Creating...

│ Error: creating RDS DB Instance (restored-from-snapshot): StorageQuotaExceeded:
│ Cannot restore snapshot because it would exceed the storage quota for
│ db.m5.large instances (maximum: 16384 GiB, requested: 20000 GiB).
│
│   with aws_db_instance.restored,
│   on database/restore.tf line 1, in resource "aws_db_instance" "restored":
│    1: resource "aws_db_instance" "restored" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 6: RDS Proxy - IAM Auth Configuration Error
# ============================================================================

Terraform will perform the following actions:

  # aws_db_proxy.app will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_proxy.app: Creating...

│ Error: creating RDS DB Proxy (app-db-proxy): InvalidParameterValue:
│ IAM authentication is not enabled on RDS DB instance production-postgres.
│ Enable IAM authentication or change client_password_auth_type to MYSQL_NATIVE_PASSWORD.
│
│   with aws_db_proxy.app,
│   on database/proxy.tf line 1, in resource "aws_db_proxy" "app":
│    1: resource "aws_db_proxy" "app" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 7: Read Replica - Source DB Not Found
# ============================================================================

Terraform will perform the following actions:

  # aws_db_instance.read_replica will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_db_instance.read_replica: Creating...

│ Error: creating RDS DB Instance (prod-read-replica): DBInstanceNotFound:
│ DBInstance source-db-instance not found.
│
│   with aws_db_instance.read_replica,
│   on database/replica.tf line 22, in resource "aws_db_instance" "read_replica":
│   22: resource "aws_db_instance" "read_replica" {

---FIXTURE_SEPARATOR---

# ============================================================================
# Test Case 8: Aurora Cluster - Global Cluster Configuration
# ============================================================================

Terraform will perform the following actions:

  # aws_rds_cluster.secondary will be created

Plan: 1 to add, 0 to change, 0 to destroy.

aws_rds_cluster.secondary: Creating...

│ Error: creating RDS Cluster (secondary-aurora-cluster): InvalidGlobalClusterStateFault:
│ Global cluster global-aurora-cluster is not in available state.
│ Current state: modifying.
│
│   with aws_rds_cluster.secondary,
│   on database/aurora.tf line 45, in resource "aws_rds_cluster" "secondary":
│   45: resource "aws_rds_cluster" "secondary" {
