{
  "format_version": "1.2",
  "terraform_version": "1.6.0",
  "planned_values": {
    "root_module": {
      "resources": [
        {
          "address": "aws_vpc.main",
          "mode": "managed",
          "type": "aws_vpc",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "cidr_block": "10.0.0.0/16",
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "tags": {
              "Name": "production-vpc",
              "Environment": "production"
            }
          }
        },
        {
          "address": "aws_subnet.public[0]",
          "mode": "managed",
          "type": "aws_subnet",
          "name": "public",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "availability_zone": "us-east-1a",
            "cidr_block": "10.0.1.0/24",
            "map_public_ip_on_launch": true
          }
        },
        {
          "address": "aws_subnet.public[1]",
          "mode": "managed",
          "type": "aws_subnet",
          "name": "public",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "availability_zone": "us-east-1b",
            "cidr_block": "10.0.2.0/24",
            "map_public_ip_on_launch": true
          }
        },
        {
          "address": "aws_subnet.private[0]",
          "mode": "managed",
          "type": "aws_subnet",
          "name": "private",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "availability_zone": "us-east-1a",
            "cidr_block": "10.0.10.0/24"
          }
        },
        {
          "address": "aws_subnet.private[1]",
          "mode": "managed",
          "type": "aws_subnet",
          "name": "private",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "availability_zone": "us-east-1b",
            "cidr_block": "10.0.11.0/24"
          }
        },
        {
          "address": "aws_internet_gateway.main",
          "mode": "managed",
          "type": "aws_internet_gateway",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "tags": {
              "Name": "production-igw"
            }
          }
        },
        {
          "address": "aws_nat_gateway.main[0]",
          "mode": "managed",
          "type": "aws_nat_gateway",
          "name": "main",
          "index": 0,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "connectivity_type": "public"
          }
        },
        {
          "address": "aws_nat_gateway.main[1]",
          "mode": "managed",
          "type": "aws_nat_gateway",
          "name": "main",
          "index": 1,
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "connectivity_type": "public"
          }
        },
        {
          "address": "aws_s3_bucket.data",
          "mode": "managed",
          "type": "aws_s3_bucket",
          "name": "data",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "company-data-lake-prod",
            "tags": {
              "Environment": "production"
            }
          }
        },
        {
          "address": "aws_s3_bucket.logs",
          "mode": "managed",
          "type": "aws_s3_bucket",
          "name": "logs",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "bucket": "company-logs-prod",
            "tags": {
              "Environment": "production"
            }
          }
        },
        {
          "address": "aws_db_instance.main",
          "mode": "managed",
          "type": "aws_db_instance",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 2,
          "values": {
            "allocated_storage": 100,
            "engine": "postgres",
            "engine_version": "15.4",
            "instance_class": "db.r6g.large",
            "db_name": "appdb",
            "multi_az": true,
            "storage_encrypted": true
          }
        },
        {
          "address": "aws_db_instance.replica",
          "mode": "managed",
          "type": "aws_db_instance",
          "name": "replica",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 2,
          "values": {
            "instance_class": "db.r6g.large",
            "replicate_source_db": "aws_db_instance.main"
          }
        },
        {
          "address": "aws_lambda_function.api",
          "mode": "managed",
          "type": "aws_lambda_function",
          "name": "api",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "function_name": "api-handler",
            "runtime": "python3.11",
            "memory_size": 256,
            "timeout": 30
          }
        },
        {
          "address": "aws_lambda_function.processor",
          "mode": "managed",
          "type": "aws_lambda_function",
          "name": "processor",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "function_name": "data-processor",
            "runtime": "python3.11",
            "memory_size": 1024,
            "timeout": 900
          }
        },
        {
          "address": "aws_iam_role.lambda_exec",
          "mode": "managed",
          "type": "aws_iam_role",
          "name": "lambda_exec",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "lambda-execution-role"
          }
        },
        {
          "address": "aws_iam_role.ecs_task",
          "mode": "managed",
          "type": "aws_iam_role",
          "name": "ecs_task",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "ecs-task-execution-role"
          }
        },
        {
          "address": "aws_ecs_cluster.main",
          "mode": "managed",
          "type": "aws_ecs_cluster",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "production-cluster"
          }
        },
        {
          "address": "aws_ecs_service.api",
          "mode": "managed",
          "type": "aws_ecs_service",
          "name": "api",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "api-service",
            "desired_count": 3
          }
        },
        {
          "address": "aws_lb.api",
          "mode": "managed",
          "type": "aws_lb",
          "name": "api",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "api-load-balancer",
            "internal": false,
            "load_balancer_type": "application"
          }
        },
        {
          "address": "aws_lb_target_group.api",
          "mode": "managed",
          "type": "aws_lb_target_group",
          "name": "api",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "api-tg",
            "port": 8080,
            "protocol": "HTTP",
            "target_type": "ip"
          }
        },
        {
          "address": "aws_security_group.alb",
          "mode": "managed",
          "type": "aws_security_group",
          "name": "alb",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "name": "alb-sg",
            "description": "Security group for ALB"
          }
        },
        {
          "address": "aws_security_group.ecs",
          "mode": "managed",
          "type": "aws_security_group",
          "name": "ecs",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "name": "ecs-sg",
            "description": "Security group for ECS tasks"
          }
        },
        {
          "address": "aws_security_group.rds",
          "mode": "managed",
          "type": "aws_security_group",
          "name": "rds",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "name": "rds-sg",
            "description": "Security group for RDS"
          }
        },
        {
          "address": "aws_elasticache_cluster.redis",
          "mode": "managed",
          "type": "aws_elasticache_cluster",
          "name": "redis",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 1,
          "values": {
            "cluster_id": "prod-redis",
            "engine": "redis",
            "node_type": "cache.r6g.large",
            "num_cache_nodes": 2
          }
        },
        {
          "address": "aws_eks_cluster.main",
          "mode": "managed",
          "type": "aws_eks_cluster",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "production-eks",
            "version": "1.28"
          }
        },
        {
          "address": "aws_eks_node_group.workers",
          "mode": "managed",
          "type": "aws_eks_node_group",
          "name": "workers",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "node_group_name": "production-workers",
            "instance_types": ["m6i.xlarge"],
            "scaling_config": {
              "desired_size": 5,
              "max_size": 10,
              "min_size": 3
            }
          }
        },
        {
          "address": "aws_cloudwatch_log_group.app",
          "mode": "managed",
          "type": "aws_cloudwatch_log_group",
          "name": "app",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "/app/production",
            "retention_in_days": 30
          }
        },
        {
          "address": "aws_sns_topic.alerts",
          "mode": "managed",
          "type": "aws_sns_topic",
          "name": "alerts",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "production-alerts"
          }
        },
        {
          "address": "aws_sqs_queue.tasks",
          "mode": "managed",
          "type": "aws_sqs_queue",
          "name": "tasks",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "name": "task-queue",
            "visibility_timeout_seconds": 300
          }
        },
        {
          "address": "aws_kms_key.main",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "main",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "schema_version": 0,
          "values": {
            "description": "Main encryption key",
            "enable_key_rotation": true
          }
        }
      ],
      "child_modules": [
        {
          "address": "module.monitoring",
          "resources": [
            {
              "address": "module.monitoring.aws_cloudwatch_dashboard.main",
              "mode": "managed",
              "type": "aws_cloudwatch_dashboard",
              "name": "main",
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "dashboard_name": "production-dashboard"
              }
            },
            {
              "address": "module.monitoring.aws_cloudwatch_metric_alarm.cpu",
              "mode": "managed",
              "type": "aws_cloudwatch_metric_alarm",
              "name": "cpu",
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 1,
              "values": {
                "alarm_name": "high-cpu-utilization",
                "comparison_operator": "GreaterThanThreshold",
                "evaluation_periods": 2,
                "metric_name": "CPUUtilization",
                "threshold": 80
              }
            },
            {
              "address": "module.monitoring.aws_cloudwatch_metric_alarm.memory",
              "mode": "managed",
              "type": "aws_cloudwatch_metric_alarm",
              "name": "memory",
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 1,
              "values": {
                "alarm_name": "high-memory-utilization",
                "comparison_operator": "GreaterThanThreshold",
                "evaluation_periods": 2,
                "metric_name": "MemoryUtilization",
                "threshold": 85
              }
            }
          ]
        },
        {
          "address": "module.azure_dr",
          "resources": [
            {
              "address": "module.azure_dr.azurerm_resource_group.main",
              "mode": "managed",
              "type": "azurerm_resource_group",
              "name": "main",
              "provider_name": "registry.terraform.io/hashicorp/azurerm",
              "schema_version": 0,
              "values": {
                "name": "rg-dr-westeurope",
                "location": "westeurope"
              }
            },
            {
              "address": "module.azure_dr.azurerm_storage_account.backup",
              "mode": "managed",
              "type": "azurerm_storage_account",
              "name": "backup",
              "provider_name": "registry.terraform.io/hashicorp/azurerm",
              "schema_version": 4,
              "values": {
                "name": "stbackupdrwesteu",
                "account_tier": "Standard",
                "account_replication_type": "GRS"
              }
            },
            {
              "address": "module.azure_dr.azurerm_kubernetes_cluster.dr",
              "mode": "managed",
              "type": "azurerm_kubernetes_cluster",
              "name": "dr",
              "provider_name": "registry.terraform.io/hashicorp/azurerm",
              "schema_version": 2,
              "values": {
                "name": "aks-dr-cluster",
                "dns_prefix": "aks-dr"
              }
            },
            {
              "address": "module.azure_dr.azurerm_cosmosdb_account.dr",
              "mode": "managed",
              "type": "azurerm_cosmosdb_account",
              "name": "dr",
              "provider_name": "registry.terraform.io/hashicorp/azurerm",
              "schema_version": 0,
              "values": {
                "name": "cosmos-dr-account",
                "offer_type": "Standard",
                "kind": "GlobalDocumentDB"
              }
            }
          ]
        }
      ]
    }
  },
  "resource_changes": [
    {
      "address": "aws_vpc.main",
      "mode": "managed",
      "type": "aws_vpc",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "cidr_block": "10.0.0.0/16",
          "enable_dns_hostnames": true
        }
      }
    },
    {
      "address": "aws_s3_bucket.data",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "data",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "bucket": "company-data-lake-prod"
        }
      }
    },
    {
      "address": "aws_s3_bucket.logs",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "logs",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "bucket": "company-logs-prod"
        }
      }
    },
    {
      "address": "aws_db_instance.main",
      "mode": "managed",
      "type": "aws_db_instance",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "allocated_storage": 100,
          "engine": "postgres"
        }
      }
    },
    {
      "address": "aws_lambda_function.api",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "api",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "function_name": "api-handler"
        }
      }
    },
    {
      "address": "aws_lambda_function.processor",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "processor",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "function_name": "data-processor"
        }
      }
    },
    {
      "address": "aws_ecs_cluster.main",
      "mode": "managed",
      "type": "aws_ecs_cluster",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "production-cluster"
        }
      }
    },
    {
      "address": "aws_eks_cluster.main",
      "mode": "managed",
      "type": "aws_eks_cluster",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "production-eks"
        }
      }
    },
    {
      "address": "module.azure_dr.azurerm_storage_account.backup",
      "mode": "managed",
      "type": "azurerm_storage_account",
      "name": "backup",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "stbackupdrwesteu"
        }
      }
    },
    {
      "address": "module.azure_dr.azurerm_kubernetes_cluster.dr",
      "mode": "managed",
      "type": "azurerm_kubernetes_cluster",
      "name": "dr",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "aks-dr-cluster"
        }
      }
    }
  ],
  "configuration": {
    "provider_config": {
      "aws": {
        "name": "aws",
        "full_name": "registry.terraform.io/hashicorp/aws",
        "version_constraint": "~> 5.0",
        "expressions": {
          "region": {
            "constant_value": "us-east-1"
          }
        }
      },
      "azurerm": {
        "name": "azurerm",
        "full_name": "registry.terraform.io/hashicorp/azurerm",
        "version_constraint": "~> 3.0"
      }
    }
  }
}
